<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>@mikesaintsg/filesystem Showcase</title>
  <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=t(a);fetch(a.href,n)}})();class v extends Error{code;path;cause;constructor(e,t,i,a){super(t),this.name="FileSystemError",this.code=e,i!==void 0&&(this.path=i),a!==void 0&&(this.cause=a)}}class k extends v{constructor(e,t){super("NOT_FOUND",e?`Entry not found: ${e}`:"Entry not found",e,t),this.name="NotFoundError"}}class H extends v{constructor(e,t,i){super("NOT_ALLOWED",e??"Permission denied",t,i),this.name="NotAllowedError"}}class B extends v{constructor(e,t,i){super("TYPE_MISMATCH",`Expected ${e} but got ${e==="file"?"directory":"file"}`,t,i),this.name="TypeMismatchError"}}class Z extends v{constructor(e,t){super("NO_MODIFICATION_ALLOWED","Modification not allowed",e,t),this.name="NoModificationAllowedError"}}class J extends v{constructor(e,t,i){super("INVALID_STATE",e??"Invalid state",t,i),this.name="InvalidStateError"}}class G extends v{constructor(e,t){super("QUOTA_EXCEEDED","Storage quota exceeded",e,t),this.name="QuotaExceededError"}}class M extends v{constructor(e,t){super("ABORT",e??"Operation aborted",void 0,t),this.name="AbortError"}}class ee extends v{constructor(e,t,i){super("SECURITY",e??"Security error",t,i),this.name="SecurityError"}}class te extends v{constructor(e,t,i){super("ENCODING",e??"Encoding error",t,i),this.name="EncodingError"}}class S extends v{constructor(e,t){super("NOT_SUPPORTED",e?`Not supported: ${e}`:"Feature not supported",void 0,t),this.name="NotSupportedError"}}function d(r,e){if(r instanceof v)return r;if(r instanceof DOMException)switch(r.name){case"NotFoundError":return new k(e,r);case"NotAllowedError":return new H(r.message,e,r);case"TypeMismatchError":return new B("file",e,r);case"NoModificationAllowedError":return new Z(e,r);case"InvalidStateError":return new J(r.message,e,r);case"QuotaExceededError":return new G(e,r);case"AbortError":return new M(r.message,r);case"SecurityError":return new ee(r.message,e,r);case"EncodingError":return new te(r.message,e,r);case"NotSupportedError":return new S(r.message,r);default:return new v("NOT_SUPPORTED",r.message,e,r)}return r instanceof Error?new v("NOT_SUPPORTED",r.message,e,r):new v("NOT_SUPPORTED",String(r),e)}function U(r){return r instanceof k}function z(r){return r instanceof H}function j(r){return r instanceof G}function R(r){return r instanceof M}function re(){return typeof navigator<"u"&&typeof navigator.storage<"u"&&typeof navigator.storage.getDirectory=="function"}function _(){return typeof window<"u"&&"showOpenFilePicker"in window&&typeof window.showOpenFilePicker=="function"}function A(r){if(r===0)return"0 B";const e=["B","KB","MB","GB","TB"],t=Math.floor(Math.log(r)/Math.log(1024));return`${(r/Math.pow(1024,t)).toFixed(t===0?0:1)} ${e[t]}`}class ie{#e;constructor(e){this.#e=e}get native(){return this.#e}async write(e){try{if(e instanceof ReadableStream){const t=e.getReader();for(;;){const{done:i,value:a}=await t.read();if(i)break;const n=new Uint8Array(a);await this.#e.write(n.buffer)}}else await this.#e.write(e)}catch(t){throw d(t)}}async seek(e){try{await this.#e.seek(e)}catch(t){throw d(t)}}async truncate(e){try{await this.#e.truncate(e)}catch(t){throw d(t)}}async close(){try{await this.#e.close()}catch(e){throw d(e)}}async abort(){try{await this.#e.abort()}catch(e){throw d(e)}}}async function Q(r,e){if(e instanceof ReadableStream){const t=e.getReader();for(;;){const{done:i,value:a}=await t.read();if(i)break;const n=new Uint8Array(a);await r.write(n.buffer)}}else await r.write(e)}let D=class{#e;constructor(e){this.#e=e}get native(){return this.#e}getName(){return this.#e.name}async getMetadata(){try{const e=await this.#e.getFile();return{name:e.name,size:e.size,type:e.type,lastModified:e.lastModified}}catch(e){throw d(e,this.#e.name)}}async getText(){try{return(await this.#e.getFile()).text()}catch(e){throw d(e,this.#e.name)}}async getArrayBuffer(){try{return(await this.#e.getFile()).arrayBuffer()}catch(e){throw d(e,this.#e.name)}}async getBlob(){try{return this.#e.getFile()}catch(e){throw d(e,this.#e.name)}}getStream(){const e=this.#e;return new ReadableStream({async start(t){try{const a=(await e.getFile()).stream().getReader();for(;;){const{done:n,value:o}=await a.read();if(n){t.close();break}t.enqueue(o)}}catch(i){t.error(d(i))}}})}async write(e,t){try{const i=await this.#e.createWritable({keepExistingData:t?.keepExistingData??!1});try{t?.position!==void 0&&await i.seek(t.position),await Q(i,e),await i.close()}catch(a){throw await i.abort(),a}}catch(i){throw d(i,this.#e.name)}}async append(e){try{const t=await this.#e.createWritable({keepExistingData:!0});try{const i=await this.#e.getFile();await t.seek(i.size),await Q(t,e),await t.close()}catch(i){throw await t.abort(),i}}catch(t){throw d(t,this.#e.name)}}async truncate(e){try{const t=await this.#e.createWritable({keepExistingData:!0});try{await t.truncate(e),await t.close()}catch(i){throw await t.abort(),i}}catch(t){throw d(t,this.#e.name)}}async openWritable(){try{const e=await this.#e.createWritable();return new ie(e)}catch(e){throw d(e,this.#e.name)}}async hasReadPermission(){try{return await this.#e.queryPermission({mode:"read"})==="granted"}catch{return!0}}async hasWritePermission(){try{return await this.#e.queryPermission({mode:"readwrite"})==="granted"}catch{return!0}}async requestWritePermission(){try{return await this.#e.requestPermission({mode:"readwrite"})==="granted"}catch(e){if(e instanceof TypeError)return!0;throw new H("Permission request failed",this.#e.name)}}async isSameEntry(e){try{return this.#e.isSameEntry(e.native)}catch(t){throw d(t,this.#e.name)}}};class x{#e;constructor(e){this.#e=e}get native(){return this.#e}getName(){return this.#e.name}async getFile(e){try{const t=await this.#e.getFileHandle(e);return new D(t)}catch(t){if(t instanceof DOMException&&t.name==="NotFoundError"||t instanceof DOMException&&t.name==="TypeMismatchError")return;throw d(t,e)}}async resolveFile(e){try{const t=await this.#e.getFileHandle(e);return new D(t)}catch(t){throw t instanceof DOMException&&t.name==="NotFoundError"?new k(e):d(t,e)}}async createFile(e){try{const t=await this.#e.getFileHandle(e,{create:!0});return new D(t)}catch(t){throw d(t,e)}}async hasFile(e){try{return await this.#e.getFileHandle(e),!0}catch(t){if(t instanceof DOMException&&t.name==="NotFoundError"||t instanceof DOMException&&t.name==="TypeMismatchError")return!1;throw d(t,e)}}async removeFile(e){try{await this.#e.getFileHandle(e),await this.#e.removeEntry(e)}catch(t){throw t instanceof DOMException&&t.name==="NotFoundError"?new k(e):t instanceof DOMException&&t.name==="TypeMismatchError"?new B("file",e):d(t,e)}}async getDirectory(e){try{const t=await this.#e.getDirectoryHandle(e);return new x(t)}catch(t){if(t instanceof DOMException&&t.name==="NotFoundError"||t instanceof DOMException&&t.name==="TypeMismatchError")return;throw d(t,e)}}async resolveDirectory(e){try{const t=await this.#e.getDirectoryHandle(e);return new x(t)}catch(t){throw t instanceof DOMException&&t.name==="NotFoundError"?new k(e):d(t,e)}}async createDirectory(e){try{const t=await this.#e.getDirectoryHandle(e,{create:!0});return new x(t)}catch(t){throw d(t,e)}}async hasDirectory(e){try{return await this.#e.getDirectoryHandle(e),!0}catch(t){if(t instanceof DOMException&&t.name==="NotFoundError"||t instanceof DOMException&&t.name==="TypeMismatchError")return!1;throw d(t,e)}}async removeDirectory(e,t){try{await this.#e.getDirectoryHandle(e),await this.#e.removeEntry(e,{recursive:t?.recursive??!1})}catch(i){throw i instanceof DOMException&&i.name==="NotFoundError"?new k(e):i instanceof DOMException&&i.name==="TypeMismatchError"?new B("directory",e):d(i,e)}}async resolvePath(...e){if(e.length===0)return this;try{let t=this.#e;for(let i=0;i<e.length;i++){const a=e[i];if(a===void 0)continue;if(t.kind!=="directory")return;const n=t;if(i===e.length-1)try{const l=await n.getFileHandle(a);return new D(l)}catch{try{const l=await n.getDirectoryHandle(a);return new x(l)}catch{return}}else try{t=await n.getDirectoryHandle(a)}catch{return}}return}catch{return}}async createPath(...e){if(e.length===0)return this;try{let t=this.#e;for(const i of e)i!==void 0&&(t=await t.getDirectoryHandle(i,{create:!0}));return new x(t)}catch(t){throw d(t,e.join("/"))}}async*entries(){try{for await(const[e,t]of this.#e.entries())yield{name:e,kind:t.kind,handle:t}}catch(e){throw d(e,this.#e.name)}}async*files(){for await(const e of this.entries())e.kind==="file"&&(yield new D(e.handle))}async*directories(){for await(const e of this.entries())e.kind==="directory"&&(yield new x(e.handle))}async list(){const e=[];for await(const t of this.entries())e.push(t);return e}async listFiles(){const e=[];for await(const t of this.files())e.push(t);return e}async listDirectories(){const e=[];for await(const t of this.directories())e.push(t);return e}async*walk(e){const t=e?.maxDepth??1/0,i=e?.includeFiles??!0,a=e?.includeDirectories??!0,n=e?.filter;yield*this.#t([],0,t,i,a,n)}async*#t(e,t,i,a,n,o){if(!(t>i))for await(const l of this.entries()){if(o!==void 0&&!o(l,t))continue;(l.kind==="file"&&a||l.kind==="directory"&&n)&&(yield{path:e,entry:l,depth:t}),l.kind==="directory"&&t<i&&(yield*new x(l.handle).#t([...e,l.name],t+1,i,a,n,o))}}async hasReadPermission(){try{return await this.#e.queryPermission({mode:"read"})==="granted"}catch{return!0}}async hasWritePermission(){try{return await this.#e.queryPermission({mode:"readwrite"})==="granted"}catch{return!0}}async requestWritePermission(){try{return await this.#e.requestPermission({mode:"readwrite"})==="granted"}catch{return!0}}async isSameEntry(e){try{return this.#e.isSameEntry(e.native)}catch(t){throw d(t,this.#e.name)}}async resolve(e){try{return this.#e.resolve(e.native)}catch(t){throw d(t,this.#e.name)}}}class O{#e;#t=null;constructor(e){this.#e=e}get native(){if(!this.#t)throw new S("File API sources do not have native handles");return this.#t}getName(){return this.#e.name}getMetadata(){return Promise.resolve({name:this.#e.name,size:this.#e.size,type:this.#e.type,lastModified:this.#e.lastModified})}getText(){return this.#e.text()}getArrayBuffer(){return this.#e.arrayBuffer()}getBlob(){return Promise.resolve(this.#e)}getStream(){return this.#e.stream()}write(){return Promise.reject(new S("Cannot write to File API sources"))}append(){return Promise.reject(new S("Cannot write to File API sources"))}truncate(){return Promise.reject(new S("Cannot write to File API sources"))}openWritable(){return Promise.reject(new S("Cannot write to File API sources"))}hasReadPermission(){return Promise.resolve(!0)}hasWritePermission(){return Promise.resolve(!1)}requestWritePermission(){return Promise.resolve(!1)}isSameEntry(e){return e instanceof O?Promise.resolve(this.#e===e.#e):Promise.resolve(!1)}}class ae{async getRoot(){try{const e=await navigator.storage.getDirectory();return new x(e)}catch(e){throw d(e)}}async getQuota(){try{const e=await navigator.storage.estimate(),t=e.usage??0,i=e.quota??0,a=i-t,n=i>0?t/i*100:0;return{usage:t,quota:i,available:a,percentUsed:n}}catch(e){throw d(e)}}isUserAccessSupported(){return typeof window<"u"&&typeof window.showOpenFilePicker=="function"}async showOpenFilePicker(e){if(!this.isUserAccessSupported())throw new S("File pickers are not supported in this browser");try{const t=e?{multiple:e.multiple,excludeAcceptAllOption:e.excludeAcceptAllOption,id:e.id,startIn:e.startIn,types:e.types?e.types.map(a=>({...a})):void 0}:void 0;return(await window.showOpenFilePicker(t)).map(a=>new D(a))}catch(t){throw t instanceof DOMException&&t.name==="AbortError"?new M("User cancelled file picker"):d(t)}}async showSaveFilePicker(e){if(!this.isUserAccessSupported())throw new S("File pickers are not supported in this browser");try{const t=e?{suggestedName:e.suggestedName,excludeAcceptAllOption:e.excludeAcceptAllOption,id:e.id,startIn:e.startIn,types:e.types?e.types.map(a=>({...a})):void 0}:void 0,i=await window.showSaveFilePicker(t);return new D(i)}catch(t){throw t instanceof DOMException&&t.name==="AbortError"?new M("User cancelled file picker"):d(t)}}async showDirectoryPicker(e){if(!this.isUserAccessSupported())throw new S("Directory picker is not supported in this browser");try{const t=await window.showDirectoryPicker(e);return new x(t)}catch(t){throw t instanceof DOMException&&t.name==="AbortError"?new M("User cancelled directory picker"):d(t)}}async fromDataTransferItem(e){if("getAsFileSystemHandle"in e&&typeof e.getAsFileSystemHandle=="function")try{const i=await e.getAsFileSystemHandle();return i?i.kind==="file"?new D(i):new x(i):null}catch{}const t=e.webkitGetAsEntry?.();if(!t){const i=e.getAsFile();return i?new O(i):null}return t.isFile?new Promise(i=>{t.file(a=>i(new O(a)),()=>i(null))}):(t.isDirectory,null)}async fromDataTransferItems(e){const t=[],i=Array.from({length:e.length},(a,n)=>e[n]);for(const a of i)if(a?.kind==="file"){const n=await this.fromDataTransferItem(a);n&&t.push(n)}return t}fromFile(e){return Promise.resolve(new O(e))}fromFiles(e){const t=Array.from({length:e.length},(a,n)=>e[n]),i=[];for(const a of t)a&&i.push(new O(a));return Promise.resolve(i)}}function ne(){return re()?Promise.resolve(new ae):Promise.reject(new S("Origin Private File System is not supported in this browser"))}const X={NOT_FOUND:"The requested file or directory was not found",NOT_ALLOWED:"Permission denied for this operation",TYPE_MISMATCH:"Expected file but got directory, or vice versa",NO_MODIFICATION_ALLOWED:"The file or directory cannot be modified",INVALID_STATE:"The file system is in an invalid state",QUOTA_EXCEEDED:"Storage quota has been exceeded",ABORT:"The operation was aborted",SECURITY:"A security error occurred",ENCODING:"An encoding error occurred",NOT_SUPPORTED:"This feature is not supported in this browser"};let h=null,s=null,L="dragdrop",b=!1,C=null;const W=[],Y=[{id:"dragdrop",emoji:"üéØ",label:"Drag & Drop",description:"Drop files and folders - works everywhere"},{id:"opfs",emoji:"üíæ",label:"OPFS Storage",description:"Origin Private File System - sandboxed storage for web apps"},{id:"directories",emoji:"üìÅ",label:"Directories",description:"Create nested directories, list contents, recursive walk"},{id:"files",emoji:"üìÑ",label:"File Operations",description:"Read/write text, binary, blob, stream formats"},{id:"streams",emoji:"üîÑ",label:"Writable Streams",description:"Streaming writes with seek, truncate, abort"},{id:"pickers",emoji:"üìÇ",label:"File Pickers",description:"Native file dialogs (Chromium only)"},{id:"errors",emoji:"‚ö†Ô∏è",label:"Error Handling",description:"Typed error classes and type guards"}],se=["opfs","directories","files","streams"];function oe(r){return se.includes(r)}function ce(r){switch(r){case"opfs":return[{id:"quota",title:"getQuota() - Storage Information",description:"Check storage usage and available space",run:le},{id:"create-file",title:"createFile() - Create File",description:"Create a new file in OPFS",run:de},{id:"read-file",title:"getText() - Read File",description:"Read file content as text",run:ue},{id:"write-file",title:"write() - Write File",description:"Write content to file (atomic)",run:fe},{id:"delete-file",title:"removeFile() - Delete File",description:"Remove a file from storage",run:pe},{id:"native-access",title:".native - Native Access",description:"Access underlying FileSystemHandle",run:me}];case"directories":return[{id:"create-dir",title:"createDirectory() - Create Directory",description:"Create a single directory",run:we},{id:"create-path",title:"createPath() - Nested Directories",description:"Create nested directories like mkdir -p",run:he},{id:"list-entries",title:"list() - List Contents",description:"List all files and directories",run:ge},{id:"iterate",title:"entries() - Async Iteration",description:"Memory-efficient directory iteration",run:ye},{id:"walk",title:"walk() - Recursive Walk",description:"Recursively walk directory tree",run:ve},{id:"walk-filter",title:"walk() with Filter",description:"Walk with depth limit and filter",run:be}];case"files":return[{id:"read-text",title:"getText() - Read as Text",description:"Read file content as string",run:Fe},{id:"read-binary",title:"getArrayBuffer() - Read as Binary",description:"Read file as ArrayBuffer",run:Ee},{id:"read-blob",title:"getBlob() - Read as Blob",description:"Read file as Blob object",run:xe},{id:"read-stream",title:"getStream() - Read as Stream",description:"Stream file content in chunks",run:Se},{id:"write-position",title:"write() with Position",description:"Write at specific byte position",run:ke},{id:"append",title:"append() - Append Data",description:"Append content to end of file",run:Pe},{id:"truncate",title:"truncate() - Resize File",description:"Truncate file to specific size",run:De},{id:"metadata",title:"getMetadata() - File Info",description:"Get file name, size, type, modified date",run:Ae}];case"streams":return[{id:"stream-write",title:"openWritable() - Stream Write",description:"Open writable stream for file",run:Ne},{id:"stream-seek",title:"seek() - Move Cursor",description:"Seek to position in stream",run:Te},{id:"stream-truncate",title:"truncate() - Resize",description:"Truncate file via stream",run:Oe},{id:"stream-abort",title:"abort() - Discard Changes",description:"Abort stream and discard changes",run:Ce}];case"pickers":return[{id:"feature-check",title:"isUserAccessSupported()",description:"Check if pickers are available",run:$e},{id:"open-picker",title:"showOpenFilePicker()",description:"Open file picker dialog",run:Me},{id:"save-picker",title:"showSaveFilePicker()",description:"Save file picker dialog",run:Le},{id:"dir-picker",title:"showDirectoryPicker()",description:"Directory picker dialog",run:Re}];case"dragdrop":return[{id:"file-input",title:"fromFile() - File Input",description:"Convert File API to FileInterface",run:Ie},{id:"file-list",title:"fromFiles() - FileList",description:"Convert FileList to FileInterface[]",run:Be}];case"errors":return[{id:"not-found",title:"NotFoundError",description:"Thrown when file/directory not found",run:We},{id:"type-guards",title:"Type Guards",description:"Safe error type checking",run:He},{id:"error-codes",title:"Error Codes",description:"All error code enumeration",run:qe}]}}function p(){return!b||!h||!s?{success:!1,message:`OPFS not available: ${C??"Unknown error"}. Try using Chrome, Edge, or Opera in normal browsing mode.`,code:`// OPFS may be unavailable due to:
// - Private/Incognito browsing mode
// - Safari iOS limitations
// - Browser security restrictions
// - Cross-origin iframe restrictions

// Check OPFS support before using:
import { isOPFSSupported } from '@mikesaintsg/filesystem'
if (isOPFSSupported()) {
    const fs = await createFileSystem()
    const root = await fs.getRoot()
}`}:null}async function le(){const r=p();if(r)return r;const e=await h.getQuota();return{success:!0,message:`Storage: ${A(e.usage)} used of ${A(e.quota)} (${e.percentUsed.toFixed(1)}% used)`,data:e,code:"const quota = await fs.getQuota()\nconsole.log(`Used: ${quota.usage} bytes`)\nconsole.log(`Quota: ${quota.quota} bytes`)\nconsole.log(`Available: ${quota.available} bytes`)\nconsole.log(`Percent: ${quota.percentUsed.toFixed(1)}%`)"}}async function de(){const r=p();if(r)return r;const e=await s.createFile("demo-file.txt");return await e.write("Hello, OPFS!"),{success:!0,message:`Created file: ${e.getName()}`,data:{name:e.getName(),content:await e.getText()},code:`const file = await root.createFile('demo-file.txt')
await file.write('Hello, OPFS!')`}}async function ue(){const r=p();if(r)return r;const e=await s.getFile("demo-file.txt");if(!e)return{success:!1,message:'File not found. Run "Create File" first.'};const t=await e.getText();return{success:!0,message:`Read ${t.length} characters from file`,data:{name:e.getName(),content:t},code:`const file = await root.getFile('demo-file.txt')
if (file) {
    const content = await file.getText()
    console.log(content)
}`}}async function fe(){const r=p();if(r)return r;const e=await s.createFile("demo-file.txt"),t=`Updated at ${new Date().toISOString()}`;return await e.write(t),{success:!0,message:"File written successfully (atomic write)",data:{name:e.getName(),content:await e.getText()},code:`const file = await root.createFile('demo-file.txt')
await file.write('New content')
// Write is atomic - content is written to temp file and swapped`}}async function pe(){const r=p();return r||(await s.hasFile("demo-file.txt")?(await s.removeFile("demo-file.txt"),{success:!0,message:"File deleted successfully",code:"await root.removeFile('demo-file.txt')"}):{success:!1,message:'File not found. Run "Create File" first.'})}async function me(){const r=p();if(r)return r;const e=await s.createFile("native-demo.txt");await e.write("Native access demo");const t=e.native,i=await t.getFile();return await s.removeFile("native-demo.txt"),{success:!0,message:"Accessed native FileSystemFileHandle",data:{handleKind:t.kind,handleName:t.name,nativeFileName:i.name,nativeFileSize:i.size},code:`const nativeHandle = file.native
// nativeHandle is FileSystemFileHandle
const nativeFile = await nativeHandle.getFile()
console.log(nativeFile.name, nativeFile.size)`}}async function we(){const r=p();if(r)return r;const e=await s.createDirectory("demo-folder");return{success:!0,message:`Created directory: ${e.getName()}`,data:{name:e.getName()},code:"const dir = await root.createDirectory('demo-folder')"}}async function he(){const r=p();return r||{success:!0,message:"Created nested directories: data/cache/images",data:{path:"data/cache/images",finalDir:(await s.createPath("data","cache","images")).getName()},code:`// Like mkdir -p
const deep = await root.createPath('data', 'cache', 'images')
// Creates all intermediate directories`}}async function ge(){const r=p();if(r)return r;await s.createFile("list-demo-1.txt"),await s.createFile("list-demo-2.txt"),await s.createDirectory("list-demo-folder");const e=await s.list(),t=e.map(i=>`${i.kind}: ${i.name}`);return await s.removeFile("list-demo-1.txt"),await s.removeFile("list-demo-2.txt"),await s.removeDirectory("list-demo-folder"),{success:!0,message:`Found ${e.length} entries`,data:t,code:"const entries = await directory.list()\nfor (const entry of entries) {\n    console.log(`${entry.kind}: ${entry.name}`)\n}"}}async function ye(){const r=p();if(r)return r;await s.createFile("iter-1.txt"),await s.createFile("iter-2.txt"),await s.createDirectory("iter-folder");const e=[];for await(const t of s.entries())if(e.push(`${t.kind}: ${t.name}`),e.length>=5)break;return await s.removeFile("iter-1.txt"),await s.removeFile("iter-2.txt"),await s.removeDirectory("iter-folder"),{success:!0,message:`Iterated ${e.length} entries (with early break support)`,data:e,code:`// Memory-efficient async iteration
for await (const entry of directory.entries()) {
    console.log(entry.name)
    if (shouldStop) break // Early break supported
}`}}async function ve(){const r=p();if(r)return r;const e=await s.createDirectory("walk-demo");await e.createFile("file1.txt"),await(await e.createDirectory("subdir")).createFile("file2.txt");const i=[];for await(const{path:a,entry:n,depth:o}of e.walk()){const l=[...a,n.name].join("/");i.push(`${"  ".repeat(o)}${n.kind}: ${l}`)}return await s.removeDirectory("walk-demo",{recursive:!0}),{success:!0,message:`Walked ${i.length} entries recursively`,data:i,code:"for await (const { path, entry, depth } of directory.walk()) {\n    const fullPath = [...path, entry.name].join('/')\n    console.log(`${'  '.repeat(depth)}${entry.kind}: ${fullPath}`)\n}"}}async function be(){const r=p();if(r)return r;const e=await s.createDirectory("walk-filter-demo");await e.createFile("visible.txt"),await e.createFile(".hidden");const t=await e.createDirectory("visible-folder");await t.createFile("deep.txt"),await(await t.createDirectory("deeper")).createFile("too-deep.txt");const a=[];for await(const{entry:n}of e.walk({maxDepth:2,includeFiles:!0,includeDirectories:!0,filter:o=>!o.name.startsWith(".")}))a.push(`${n.kind}: ${n.name}`);return await s.removeDirectory("walk-filter-demo",{recursive:!0}),{success:!0,message:`Walked ${a.length} entries with maxDepth=2 and hidden file filter`,data:a,code:`for await (const { entry } of directory.walk({
    maxDepth: 2,
    includeFiles: true,
    includeDirectories: true,
    filter: (e) => !e.name.startsWith('.')
})) {
    console.log(entry.name)
}`}}async function Fe(){const r=p();if(r)return r;const e=await s.createFile("text-demo.txt");await e.write("Hello, World! üåç");const t=await e.getText();return await s.removeFile("text-demo.txt"),{success:!0,message:`Read text: "${t}"`,data:{text:t,length:t.length},code:"const text = await file.getText()"}}async function Ee(){const r=p();if(r)return r;const e=await s.createFile("binary-demo.bin");await e.write(new Uint8Array([72,101,108,108,111]));const t=await e.getArrayBuffer(),i=new Uint8Array(t);return await s.removeFile("binary-demo.bin"),{success:!0,message:`Read ${t.byteLength} bytes as ArrayBuffer`,data:{byteLength:t.byteLength,bytes:Array.from(i)},code:`const buffer = await file.getArrayBuffer()
const view = new Uint8Array(buffer)`}}async function xe(){const r=p();if(r)return r;const e=await s.createFile("blob-demo.txt");await e.write("Blob content");const t=await e.getBlob();return await s.removeFile("blob-demo.txt"),{success:!0,message:`Read as Blob: ${t.size} bytes, type: ${t.type||"unknown"}`,data:{size:t.size,type:t.type},code:`const blob = await file.getBlob()
console.log(blob.size, blob.type)`}}async function Se(){const r=p();if(r)return r;const e="Stream content: chunk by chunk processing",t=await s.createFile("stream-demo.txt");await t.write(e);const a=t.getStream().getReader();let n=0,o=0;for(;;){const{done:l,value:f}=await a.read();if(l)break;n+=f.length,o++}return await s.removeFile("stream-demo.txt"),{success:!0,message:`Streamed ${n} bytes in ${o} chunk(s)`,data:{totalBytes:n,chunks:o},code:`const stream = file.getStream()
const reader = stream.getReader()
while (true) {
    const { done, value } = await reader.read()
    if (done) break
    processChunk(value)
}`}}async function ke(){const r=p();if(r)return r;const e=await s.createFile("position-demo.txt");await e.write("Hello, World!"),await e.write("XXXXX",{position:7,keepExistingData:!0});const t=await e.getText();return await s.removeFile("position-demo.txt"),{success:!0,message:`Wrote at position 7: "${t}"`,data:{before:"Hello, World!",after:t},code:`await file.write('Hello, World!')
await file.write('XXXXX', { position: 7, keepExistingData: true })
// Result: "Hello, XXXXX!"`}}async function Pe(){const r=p();if(r)return r;const e=await s.createFile("append-demo.txt");await e.write("Line 1"),await e.append(`
Line 2`),await e.append(`
Line 3`);const t=await e.getText();return await s.removeFile("append-demo.txt"),{success:!0,message:"Appended 2 lines to file",data:{content:t,lines:t.split(`
`)},code:`await file.write('Line 1')
await file.append('\\nLine 2')
await file.append('\\nLine 3')`}}async function De(){const r=p();if(r)return r;const e=await s.createFile("truncate-demo.txt");await e.write("This is a long string that will be truncated");const t=await e.getText();await e.truncate(10);const i=await e.getText();return await s.removeFile("truncate-demo.txt"),{success:!0,message:`Truncated from ${t.length} to ${i.length} bytes`,data:{before:t,after:i},code:`await file.write('Long content...')
await file.truncate(10) // File is now 10 bytes`}}async function Ae(){const r=p();if(r)return r;const e=await s.createFile("metadata-demo.txt");await e.write("Metadata demo content");const t=await e.getMetadata();return await s.removeFile("metadata-demo.txt"),{success:!0,message:`File: ${t.name}, Size: ${A(t.size)}`,data:{name:t.name,size:t.size,type:t.type,lastModified:new Date(t.lastModified).toISOString()},code:`const metadata = await file.getMetadata()
console.log(metadata.name)         // 'document.txt'
console.log(metadata.size)         // 1024
console.log(metadata.type)         // 'text/plain'
console.log(metadata.lastModified) // timestamp`}}async function Ne(){const r=p();if(r)return r;const e=await s.createFile("writable-demo.txt"),t=await e.openWritable();await t.write("First chunk"),await t.write(" | "),await t.write("Second chunk"),await t.close();const i=await e.getText();return await s.removeFile("writable-demo.txt"),{success:!0,message:`Wrote via stream: "${i}"`,data:{content:i},code:`const writable = await file.openWritable()
await writable.write('First chunk')
await writable.write(' | ')
await writable.write('Second chunk')
await writable.close() // Commit changes`}}async function Te(){const r=p();if(r)return r;const e=await s.createFile("seek-demo.txt"),t=await e.openWritable();await t.write("AAAAAAAAAA"),await t.seek(5),await t.write("BBBBB"),await t.close();const i=await e.getText();return await s.removeFile("seek-demo.txt"),{success:!0,message:`Seek and overwrite: "${i}"`,data:{content:i},code:`const writable = await file.openWritable()
await writable.write('AAAAAAAAAA')
await writable.seek(5)
await writable.write('BBBBB')
await writable.close()
// Result: "AAAAABBBBB"`}}async function Oe(){const r=p();if(r)return r;const e=await s.createFile("stream-truncate-demo.txt"),t=await e.openWritable();await t.write("This content will be partially truncated"),await t.truncate(12),await t.close();const i=await e.getText();return await s.removeFile("stream-truncate-demo.txt"),{success:!0,message:`Truncated via stream: "${i}"`,data:{content:i,length:i.length},code:`const writable = await file.openWritable()
await writable.write('Long content here')
await writable.truncate(12)
await writable.close()`}}async function Ce(){const r=p();if(r)return r;const e=await s.createFile("abort-demo.txt");await e.write("Original content");const t=await e.openWritable();await t.write("This will be discarded"),await t.abort();const i=await e.getText();return await s.removeFile("abort-demo.txt"),{success:!0,message:`Aborted stream - original preserved: "${i}"`,data:{content:i},code:`await file.write('Original content')
const writable = await file.openWritable()
await writable.write('This will be discarded')
await writable.abort() // Discard changes
// File still contains 'Original content'`}}function $e(){const r=h?.isUserAccessSupported()??!1;return{success:!0,message:r?"File pickers ARE supported in this browser":"File pickers NOT supported (use fallbacks)",data:{supported:r,browser:navigator.userAgent.includes("Chrome")?"Chromium":"Other"},code:`if (fs.isUserAccessSupported()) {
    // Safe to use showOpenFilePicker, showSaveFilePicker, showDirectoryPicker
    const files = await fs.showOpenFilePicker()
} else {
    // Fall back to <input type="file"> or drag-drop
}`}}async function Me(){if(!h?.isUserAccessSupported())return{success:!1,message:"File pickers not supported in this browser. Use Chrome, Edge, or Opera.",code:`// Fallback for unsupported browsers
const input = document.createElement('input')
input.type = 'file'
input.onchange = () => console.log(input.files)
input.click()`};try{const r=await h.showOpenFilePicker({multiple:!0,types:[{description:"Text Files",accept:{"text/*":[".txt",".md",".json"]}}]}),e=await Promise.all(r.map(async t=>({name:t.getName(),size:(await t.getMetadata()).size})));return{success:!0,message:`Selected ${r.length} file(s)`,data:e,code:`const files = await fs.showOpenFilePicker({
    multiple: true,
    types: [{
        description: 'Text Files',
        accept: { 'text/*': ['.txt', '.md', '.json'] }
    }]
})`}}catch(r){if(R(r))return{success:!0,message:"User cancelled picker (AbortError)"};throw r}}async function Le(){if(!h?.isUserAccessSupported())return{success:!1,message:"File pickers not supported in this browser.",code:`// Fallback: download blob
const blob = new Blob(['content'], { type: 'text/plain' })
const url = URL.createObjectURL(blob)
const a = document.createElement('a')
a.href = url
a.download = 'file.txt'
a.click()`};try{const r=await h.showSaveFilePicker({suggestedName:"demo-export.txt",types:[{description:"Text Files",accept:{"text/plain":[".txt"]}}]});return await r.write(`Exported at ${new Date().toISOString()}`),{success:!0,message:`Saved file: ${r.getName()}`,data:{name:r.getName()},code:`const file = await fs.showSaveFilePicker({
    suggestedName: 'document.txt',
    types: [{ accept: { 'text/plain': ['.txt'] } }]
})
await file.write('Content to save')`}}catch(r){if(R(r))return{success:!0,message:"User cancelled picker (AbortError)"};throw r}}async function Re(){if(!h?.isUserAccessSupported())return{success:!1,message:"Directory picker not supported in this browser."};try{const r=await h.showDirectoryPicker({mode:"read"}),e=await r.list();return{success:!0,message:`Selected directory: ${r.getName()} (${e.length} entries)`,data:{name:r.getName(),entryCount:e.length,entries:e.slice(0,5).map(t=>`${t.kind}: ${t.name}`)},code:`const dir = await fs.showDirectoryPicker({ mode: 'read' })
for await (const entry of dir.entries()) {
    console.log(entry.name)
}`}}catch(r){if(R(r))return{success:!0,message:"User cancelled picker (AbortError)"};throw r}}async function Ie(){const r=new File(["Demo file content"],"demo.txt",{type:"text/plain"});if(!h){const i=await r.text();return{success:!0,message:`Direct File API: ${r.name}`,data:{name:r.name,content:i},code:`// Without fs wrapper, use File API directly
const file = input.files[0]
const content = await file.text()
console.log(content)`}}const e=await h.fromFile(r),t=await e.getText();return{success:!0,message:`Converted File to FileInterface: ${e.getName()}`,data:{name:e.getName(),content:t},code:`// From file input or drag-drop
const nativeFile = input.files[0]
const file = await fs.fromFile(nativeFile)
const content = await file.getText()
// Note: fromFile creates read-only wrapper`}}async function Be(){const r=new DataTransfer;r.items.add(new File(["Content 1"],"file1.txt",{type:"text/plain"})),r.items.add(new File(["Content 2"],"file2.txt",{type:"text/plain"}));const e=r.files;if(!h){const i=Array.from(e).map(a=>a.name);return{success:!0,message:`Direct File API: ${e.length} files`,data:i,code:`// Without fs wrapper, iterate FileList directly
for (const file of input.files) {
    const content = await file.text()
    console.log(file.name, content)
}`}}const t=await h.fromFiles(e);return{success:!0,message:`Converted ${t.length} files from FileList`,data:t.map(i=>i.getName()),code:`// From <input type="file" multiple>
const files = await fs.fromFiles(input.files)
for (const file of files) {
    console.log(file.getName())
}`}}async function We(){if(!b||!s){const r=new k("non-existent-file.txt");return{success:!0,message:`NotFoundError class: ${r.message}`,data:{code:r.code,path:r.path,name:r.name},code:`import { NotFoundError } from '@mikesaintsg/filesystem'

// Error is thrown when file/directory not found
try {
    await directory.resolveFile('missing.txt')
} catch (error) {
    if (error instanceof NotFoundError) {
        console.log(\`File not found: \${error.path}\`)
        console.log(\`Error code: \${error.code}\`)
    }
}`}}try{return await s.resolveFile("non-existent-file-12345.txt"),{success:!1,message:"Expected NotFoundError"}}catch(r){if(r instanceof k)return{success:!0,message:`Caught NotFoundError: ${r.message}`,data:{code:r.code,path:r.path},code:`try {
    await directory.resolveFile('missing.txt')
} catch (error) {
    if (error instanceof NotFoundError) {
        console.log(\`File not found: \${error.path}\`)
        console.log(\`Error code: \${error.code}\`)
    }
}`};throw r}}async function He(){if(!b||!s){const r=new k("test.txt");return{success:!0,message:"Type guards provide safe error checking (simulated)",data:{isNotFoundError:U(r),isNotAllowedError:z(r),isQuotaExceededError:j(r),isAbortError:R(r)},code:`import { isNotFoundError, isNotAllowedError } from '@mikesaintsg/filesystem'

try {
    await directory.resolveFile('file.txt')
} catch (error) {
    if (isNotFoundError(error)) {
        // error is typed as NotFoundError
        console.log(error.path)
    } else if (isNotAllowedError(error)) {
        // error is typed as NotAllowedError
    }
}`}}try{await s.resolveFile("non-existent-file.txt")}catch(r){return{success:!0,message:"Type guards provide safe error checking",data:{isNotFoundError:U(r),isNotAllowedError:z(r),isQuotaExceededError:j(r),isAbortError:R(r)},code:`import { isNotFoundError, isNotAllowedError } from '@mikesaintsg/filesystem'

try {
    await directory.resolveFile('file.txt')
} catch (error) {
    if (isNotFoundError(error)) {
        // error is typed as NotFoundError
        console.log(error.path)
    } else if (isNotAllowedError(error)) {
        // error is typed as NotAllowedError
    }
}`}}return{success:!1,message:"Expected error"}}function qe(){return{success:!0,message:`${Object.keys(X).length} error codes available`,data:X,code:`import { ERROR_MESSAGES } from '@mikesaintsg/filesystem'

// Available error codes:
// NOT_FOUND, NOT_ALLOWED, TYPE_MISMATCH,
// NO_MODIFICATION_ALLOWED, INVALID_STATE,
// QUOTA_EXCEEDED, ABORT, SECURITY,
// ENCODING, NOT_SUPPORTED`}}const Ue=["unsafe for access","too many calls","certain files are unsafe"];function ze(){if(!C)return!1;const r=C.toLowerCase(),e=Ue.some(i=>r.includes(i));if(!e)return!1;const t=/android/i.test(navigator.userAgent);return e||e&&t}function je(){return window.location.protocol==="file:"}function _e(){return window.isSecureContext??!1}function V(){const r=ze(),e=je(),t=_e(),i=e?`
		<div class="unavailable-bug-notice" style="border-color: #e74c3c; background: #fdf0ed;">
			<h5>üìÅ Opening from Local File System</h5>
			<p>You're opening this file directly from your file system (<code>file://</code> protocol).</p>
			<p><strong>OPFS requires a web server</strong> - it cannot work when opening HTML files directly.</p>
			<p><strong>Solutions:</strong></p>
			<ul>
				<li>üåê <strong>Use a local server:</strong> Run <code>npx serve .</code> or <code>python -m http.server</code></li>
				<li>üíª <strong>Use the dev server:</strong> Run <code>npm run dev</code> in the project directory</li>
				<li>‚òÅÔ∏è <strong>Deploy to a web host:</strong> GitHub Pages, Netlify, Vercel, etc.</li>
			</ul>
		</div>
	`:"",a=!t&&!e?`
		<div class="unavailable-bug-notice" style="border-color: #f39c12; background: #fef9e7;">
			<h5>üîì Non-Secure Context</h5>
			<p>OPFS requires a <strong>secure context</strong> (HTTPS or localhost).</p>
			<p>You're currently on: <code>${window.location.origin}</code></p>
			<p><strong>Solution:</strong> Access via HTTPS or localhost.</p>
		</div>
	`:"";return`
		<div class="demo-app opfs-unavailable">
			<h4>‚ö†Ô∏è OPFS Not Available</h4>
			<p class="demo-desc">Origin Private File System is not accessible in your current browser context.</p>

			${i}
			${a}
			${r?`
		<div class="unavailable-bug-notice">
			<h5>üêõ Known Browser Bug Detected</h5>
			<p>This error appears to be caused by a <strong>known bug in Android WebView/Chromium</strong>.</p>
			<p><strong>This is NOT a limitation of your browser or this library</strong> - it's a temporary bug.</p>
			<p><strong>Workarounds:</strong></p>
			<ul>
				<li>üì≤ Update your browser/WebView to the latest version</li>
				<li>üíª Try on a desktop browser for full functionality</li>
				<li>üîÑ Use IndexedDB as a fallback (see our <a href="https://github.com/mikesaintsg/filesystem/blob/main/guides/polyfill.md" target="_blank">Polyfill Guide</a>)</li>
			</ul>
		</div>
	`:""}

			<div class="unavailable-reasons">
				<h5>Possible reasons:</h5>
				<ul>
					${e?"<li>üìÅ <strong>file:// protocol</strong> - OPFS requires a web server</li>":""}
					${!t&&!e?"<li>üîì <strong>Non-secure context</strong> - OPFS requires HTTPS or localhost</li>":""}
					${r?"<li>üêõ <strong>Browser bug</strong> - Known issue, fix is rolling out</li>":""}
					<li>üîí <strong>Private/Incognito browsing mode</strong> - OPFS is often disabled</li>
					<li>üì± <strong>Safari iOS limitations</strong> - Safari has partial OPFS support</li>
					<li>üåê <strong>Cross-origin iframe</strong> - OPFS requires same-origin context</li>
					<li>‚öôÔ∏è <strong>Browser security restrictions</strong> - Some browsers block storage APIs</li>
				</ul>
			</div>

			<div class="unavailable-error">
				<h5>Error details:</h5>
				<code>${C??"Unknown error"}</code>
				<div style="margin-top: 8px; font-size: 12px; color: #666;">
					<strong>Protocol:</strong> ${window.location.protocol} |
					<strong>Secure Context:</strong> ${t?"Yes":"No"} |
					<strong>Origin:</strong> ${window.location.origin}
				</div>
			</div>

			<div class="unavailable-alternatives">
				<h5>Try these alternatives:</h5>
				<ul>
					${e?"<li>üåê <strong>Run a local server</strong> - Use <code>npm run dev</code> or <code>npx serve .</code></li>":""}
					<li>‚úÖ Use the <strong>Drag & Drop</strong> tab - works everywhere!</li>
					<li>‚úÖ Use the <strong>Error Handling</strong> tab - demonstrates API usage</li>
					<li>‚úÖ Open in <strong>Chrome, Edge, or Opera</strong> on desktop in normal browsing mode</li>
					<li>‚úÖ Check the <strong>API Reference Examples</strong> below to see code snippets</li>
					<li>üìñ Read our <strong><a href="https://github.com/mikesaintsg/filesystem/blob/main/guides/polyfill.md" target="_blank">Polyfill Guide</a></strong> for IndexedDB fallback</li>
				</ul>
			</div>
		</div>
	`}function Qe(){return!b||!h||!s?{html:V()}:{html:`
			<div class="demo-app opfs-demo">
				<h4>üì¶ OPFS File Manager</h4>
				<p class="demo-desc">Create, edit, and manage files in your browser's private storage</p>

				<div class="demo-form">
					<input type="text" id="filename-input" class="demo-input" placeholder="Filename (e.g., notes.txt)" value="notes.txt">
					<button id="create-btn" class="btn primary">Create File</button>
				</div>

				<div class="editor-section">
					<textarea id="file-content" class="demo-textarea" placeholder="Select or create a file to edit..."></textarea>
					<div class="editor-actions">
						<button id="save-btn" class="btn primary" disabled>üíæ Save</button>
						<button id="delete-btn" class="btn danger" disabled>üóëÔ∏è Delete</button>
					</div>
				</div>

				<div class="file-list-section">
					<h5>üìÇ Files in OPFS Root</h5>
					<div id="file-list" class="demo-list">
						<p class="placeholder">Loading files...</p>
					</div>
				</div>

				<div class="quota-display">
					<span id="quota-info">Loading quota...</span>
				</div>
			</div>
		`,init:async r=>{const e=r.querySelector("#filename-input"),t=r.querySelector("#create-btn"),i=r.querySelector("#file-content"),a=r.querySelector("#save-btn"),n=r.querySelector("#delete-btn"),o=r.querySelector("#file-list"),l=r.querySelector("#quota-info");if(!e||!t||!i||!a||!n||!o||!l)return;const f=e,c=t,m=i,w=a,g=n,y=o,P=l;let F=null;const N=async()=>{const E=await h.getQuota();P.textContent=`Storage: ${A(E.usage)} / ${A(E.quota)} (${E.percentUsed.toFixed(1)}% used)`},T=async()=>{const E=await s.listFiles();if(E.length===0){y.innerHTML='<p class="placeholder">No files yet. Create one!</p>';return}y.innerHTML="";for(const $ of E){const q=await $.getMetadata(),I=document.createElement("div");I.className="list-item",I.innerHTML=`
						<div class="item-info">
							<strong>üìÑ ${$.getName()}</strong>
							<span class="item-meta">${A(q.size)} ¬∑ ${new Date(q.lastModified).toLocaleString()}</span>
						</div>
						<button class="btn small primary select-btn">Open</button>
					`,I.querySelector(".select-btn")?.addEventListener("click",()=>{(async()=>(F=$,f.value=$.getName(),m.value=await $.getText(),w.disabled=!1,g.disabled=!1))()}),y.appendChild(I)}};c.addEventListener("click",()=>{(async()=>{const E=f.value.trim();E&&(F=await s.createFile(E),m.value="",w.disabled=!1,g.disabled=!1,await T(),await N())})()}),w.addEventListener("click",()=>{(async()=>F&&(await F.write(m.value),await T(),await N()))()}),g.addEventListener("click",()=>{(async()=>F&&(await s.removeFile(F.getName()),F=null,m.value="",f.value="",w.disabled=!0,g.disabled=!0,await T(),await N()))()}),await T(),await N()}}}function Xe(){return!b||!h||!s?{html:V()}:{html:`
			<div class="demo-app directory-demo">
				<h4>üóÇÔ∏è Directory Explorer</h4>
				<p class="demo-desc">Create nested directories and explore the file tree</p>

				<div class="demo-form">
					<input type="text" id="path-input" class="demo-input" placeholder="Path (e.g., projects/webapp/src)" value="projects/webapp/src">
					<button id="create-path-btn" class="btn primary">Create Path</button>
				</div>

				<div class="tree-section">
					<h5>üìÅ Directory Tree</h5>
					<div id="dir-tree" class="demo-tree">
						<p class="placeholder">Loading...</p>
					</div>
				</div>

				<div class="walk-stats">
					<span id="walk-stats">Directories: 0 | Files: 0</span>
				</div>

				<button id="cleanup-btn" class="btn danger small">üóëÔ∏è Clean Demo Directories</button>
			</div>
		`,init:async r=>{const e=r.querySelector("#path-input"),t=r.querySelector("#create-path-btn"),i=r.querySelector("#dir-tree"),a=r.querySelector("#walk-stats"),n=r.querySelector("#cleanup-btn");if(!e||!t||!i||!a||!n)return;const o=e,l=t,f=i,c=a,m=n,w=async()=>{let g=0,y=0;const P=[];P.push("üìÅ / (OPFS Root)");for await(const{entry:F,depth:N}of s.walk({maxDepth:4})){const T="  ".repeat(N+1),E=F.kind==="file"?"üìÑ":"üìÅ";P.push(`${T}${E} ${F.name}`),F.kind==="file"?y++:g++}P.length===1?f.innerHTML='<p class="placeholder">Empty. Create some directories!</p>':f.innerHTML=`<pre class="tree-view">${P.join(`
`)}</pre>`,c.textContent=`Directories: ${g} | Files: ${y}`};l.addEventListener("click",()=>{(async()=>{const g=o.value.trim();if(!g)return;const y=g.split("/").filter(P=>P);await s.createPath(...y),await w()})()}),m.addEventListener("click",()=>{(async()=>{const g=await s.list();for(const y of g)y.kind==="directory"&&await s.removeDirectory(y.name,{recursive:!0});await w()})()}),await w()}}}function Ge(){const r=e=>({native:null,getName:()=>e.name,getMetadata:()=>Promise.resolve({name:e.name,size:e.size,type:e.type,lastModified:e.lastModified}),getText:()=>e.text(),getArrayBuffer:()=>e.arrayBuffer(),getBlob:()=>Promise.resolve(e),getStream:()=>e.stream(),write:()=>Promise.reject(new Error("Read-only file")),append:()=>Promise.reject(new Error("Read-only file")),truncate:()=>Promise.reject(new Error("Read-only file")),openWritable:()=>Promise.reject(new Error("Read-only file")),hasReadPermission:()=>Promise.resolve(!0),hasWritePermission:()=>Promise.resolve(!1),requestWritePermission:()=>Promise.resolve(!1),isSameEntry:()=>Promise.resolve(!1)});return{html:`
			<div class="demo-app dragdrop-demo">
				<h4>üéØ Drag & Drop Zone</h4>
				<p class="demo-desc">Drop files or folders here to inspect them${b?"":" (works without OPFS!)"}</p>

				<div id="drop-zone" class="drop-zone">
					<div class="drop-content">
						<span class="drop-icon">üìÅ</span>
						<p>Drop files or folders here</p>
						<p class="drop-hint">or click to select files</p>
					</div>
					<input type="file" id="file-input" multiple hidden>
				</div>

				<div id="drop-results" class="drop-results">
					<p class="placeholder">Drop something to see results...</p>
				</div>
			</div>
		`,init:e=>{const t=e.querySelector("#drop-zone"),i=e.querySelector("#file-input"),a=e.querySelector("#drop-results");if(!t||!i||!a)return;const n=t,o=i,l=a,f=async c=>{if(c.length===0){l.innerHTML='<p class="placeholder">No files found</p>';return}const m=[];for(const w of c){const g=await w.getMetadata(),y=g.size<1e3?await w.getText():"[Large file]";m.push(`
						<div class="result-item">
							<strong>üìÑ ${w.getName()}</strong>
							<span class="item-meta">${A(g.size)} ¬∑ ${g.type||"unknown type"}</span>
							<pre class="content-preview">${y.slice(0,200)}${y.length>200?"...":""}</pre>
						</div>
					`)}l.innerHTML=m.join("")};n.addEventListener("click",()=>o.click()),n.addEventListener("dragover",c=>{c.preventDefault(),n.classList.add("dragover")}),n.addEventListener("dragleave",()=>{n.classList.remove("dragover")}),n.addEventListener("drop",c=>{c.preventDefault(),n.classList.remove("dragover"),(async()=>{const m=c.dataTransfer?.items;if(!m)return;const w=[];for(const g of m)if(g.kind==="file"){const y=g.getAsFile();y&&(h?w.push(await h.fromFile(y)):w.push(r(y)))}await f(w)})()}),o.addEventListener("change",()=>{(async()=>{if(o.files)if(h){const c=await h.fromFiles(o.files);await f(c)}else{const c=Array.from(o.files).map(r);await f(c)}})()})}}}function Ye(r){switch(r){case"opfs":return Qe();case"directories":return Xe();case"dragdrop":return Ge();default:return}}function u(r,e){const t=document.createElement(r);return e?.className&&(t.className=e.className),e?.textContent&&(t.textContent=e.textContent),e?.id&&(t.id=e.id),t}function Ve(r){if(r===void 0)return"undefined";if(r===null)return"null";try{return JSON.stringify(r,null,2)}catch{return typeof r=="string"?r:"[Object]"}}function K(){W.forEach(c=>c()),W.length=0;const r=document.getElementById("app");if(!r)return;r.innerHTML="";const e=u("div",{className:"container"}),t=u("header"),i=u("h1",{textContent:"üìÇ File System Showcase"}),a=u("p",{textContent:"Comprehensive demonstration of @mikesaintsg/filesystem features"}),n=u("div",{className:"support-badges"});if(n.innerHTML=`
		<span class="badge ${b?"supported":"unsupported"}">
			${b?"‚úÖ":"‚ùå"} OPFS
		</span>
		<span class="badge ${_()?"supported":"unsupported"}">
			${_()?"‚úÖ":"‚ùå"} File Pickers
		</span>
	`,t.append(i,a,n),!b){const c=u("div",{className:"info-banner"});c.innerHTML=`
			<strong>üì± Limited Mode:</strong> OPFS is not available in your current browser context.
			<span class="info-detail">The Drag & Drop and Error Handling tabs work without OPFS. Try Chrome, Edge, or Opera in normal browsing mode for full functionality.</span>
		`,t.appendChild(c)}const o=u("nav",{className:"tabs"});Y.forEach(c=>{const m=oe(c.id)&&!b,w=u("button",{className:`tab ${L===c.id?"active":""} ${m?"disabled-tab":""}`,textContent:`${c.emoji} ${c.label}`});w.title=m?`${c.description} (requires OPFS)`:c.description,w.addEventListener("click",()=>{L=c.id,K()}),o.appendChild(w)});const l=u("main",{id:"content"});Ke(l);const f=u("footer");f.innerHTML="<p>Zero dependencies ¬∑ Full TypeScript support ¬∑ MIT License</p>",e.append(t,o,l,f),r.appendChild(e)}async function Ke(r){const e=Y.find(f=>f.id===L);if(!e)return;const t=u("section",{className:"card"}),i=u("h2",{textContent:`${e.emoji} ${e.label}`}),a=u("p",{className:"subtitle",textContent:e.description});t.append(i,a);const n=Ye(L);if(n){const f=u("div",{className:"interactive-demo-container"});if(f.innerHTML=n.html,t.appendChild(f),n.init)try{await n.init(f)}catch(m){console.error("Demo init error:",m)}n.cleanup&&W.push(n.cleanup);const c=u("div",{className:"demo-separator"});c.innerHTML="<h3>üìö API Reference Examples</h3>",t.appendChild(c)}const o=ce(L),l=u("div",{className:"examples-container"});o.forEach(f=>{const c=Ze(f);l.appendChild(c)}),t.appendChild(l),r.appendChild(t)}function Ze(r){const e=u("div",{className:"example-card"}),t=u("div",{className:"example-header"}),i=u("h3",{textContent:r.title}),a=u("p",{className:"example-desc",textContent:r.description});t.append(i,a);const n=u("button",{className:"btn primary",textContent:"‚ñ∂ Run Example"}),o=u("div",{className:"example-result"});return o.style.display="none",n.addEventListener("click",()=>{Je(r,n,o)}),e.append(t,n,o),e}async function Je(r,e,t){e.disabled=!0,e.textContent="‚è≥ Running...",t.style.display="block",t.innerHTML='<p class="loading">Running example...</p>';try{const i=await r.run();t.innerHTML="";const a=i.success?"success":"error",n=i.success?"‚úÖ":"‚ùå",o=u("p",{className:`result-message ${a}`,textContent:`${n} ${i.message}`});if(t.appendChild(o),i.data!==void 0){const l=u("div",{className:"result-data"}),f=u("h4",{textContent:"üìä Result Data"}),c=u("pre"),m=u("code",{textContent:Ve(i.data)});c.appendChild(m),l.append(f,c),t.appendChild(l)}if(i.code){const l=u("div",{className:"result-code"}),f=u("h4",{textContent:"üíª Code Example"}),c=u("div",{className:"code-block"}),m=u("pre"),w=u("code",{textContent:i.code});m.appendChild(w),c.appendChild(m),l.append(f,c),t.appendChild(l)}}catch(i){t.innerHTML="";const a=u("p",{className:"result-message error",textContent:`‚ùå Error: ${i instanceof Error?i.message:String(i)}`});t.appendChild(a)}finally{e.disabled=!1,e.textContent="‚ñ∂ Run Example"}}async function et(){try{h=await ne(),s=await h.getRoot(),b=!0,C=null,console.log("@mikesaintsg/filesystem showcase loaded with OPFS support")}catch(r){console.warn("OPFS not available:",r),b=!1,C=r instanceof Error?r.message:String(r),console.log("@mikesaintsg/filesystem showcase loaded in limited mode (no OPFS)")}K()}et();</script>
  <style rel="stylesheet" crossorigin>*{box-sizing:border-box;margin:0;padding:0}:root{--primary: #3b82f6;--primary-hover: #2563eb;--danger: #dc2626;--danger-hover: #b91c1c;--warning: #f59e0b;--success: #10b981;--secondary: #6b7280;--secondary-hover: #4b5563;--bg: #f3f4f6;--card-bg: #ffffff;--text: #1f2937;--text-muted: #6b7280;--border: #e5e7eb;--radius: 8px;--shadow: 0 1px 3px rgba(0, 0, 0, .1);--shadow-lg: 0 4px 6px -1px rgba(0, 0, 0, .1)}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,sans-serif;background:var(--bg);color:var(--text);line-height:1.5;min-height:100vh}.container{max-width:900px;margin:0 auto;padding:20px}header{text-align:center;margin-bottom:24px}header h1{font-size:2rem;margin-bottom:8px;color:var(--primary)}header p{color:var(--text-muted);margin-bottom:12px}.support-badges{display:flex;justify-content:center;gap:12px;flex-wrap:wrap}.badge{padding:6px 12px;border-radius:20px;font-size:.85rem;font-weight:500}.badge.supported{background:#d1fae5;color:#065f46}.badge.unsupported{background:#fee2e2;color:#991b1b}footer{text-align:center;margin-top:32px;padding:16px;color:var(--text-muted);font-size:.875rem;border-top:1px solid var(--border)}.tabs{display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap}.tab{padding:10px 16px;border:none;background:var(--card-bg);border-radius:var(--radius);cursor:pointer;font-size:.9rem;font-weight:500;transition:all .2s;box-shadow:var(--shadow)}.tab:hover{background:var(--border)}.tab.active{background:var(--primary);color:#fff}.card{background:var(--card-bg);border-radius:var(--radius);padding:24px;box-shadow:var(--shadow-lg)}.card h2{margin-bottom:4px;font-size:1.5rem}.card .subtitle{color:var(--text-muted);margin-bottom:20px;font-size:.875rem}.btn{padding:10px 18px;border:none;border-radius:var(--radius);font-size:.95rem;font-weight:500;cursor:pointer;transition:all .2s;white-space:nowrap}.btn.small{padding:6px 12px;font-size:.85rem}.btn.primary{background:var(--primary);color:#fff}.btn.primary:hover{background:var(--primary-hover)}.btn.secondary{background:var(--secondary);color:#fff}.btn.secondary:hover{background:var(--secondary-hover)}.btn.danger{background:var(--danger);color:#fff}.btn.danger:hover{background:var(--danger-hover)}.btn:disabled{opacity:.5;cursor:not-allowed}.interactive-demo-container{margin-bottom:24px}.demo-app{background:#fff;border:2px solid var(--primary);border-radius:var(--radius);padding:20px;margin-bottom:16px}.demo-app h4{font-size:1.1rem;color:var(--primary);margin-bottom:8px}.demo-app .demo-desc{font-size:.85rem;color:var(--text-muted);margin-bottom:16px}.demo-form{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px}.demo-input{padding:10px 14px;border:1px solid var(--border);border-radius:var(--radius);font-size:.9rem;flex:1;min-width:150px}.demo-input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px #3b82f61a}.demo-textarea{width:100%;min-height:150px;padding:12px;border:1px solid var(--border);border-radius:var(--radius);font-family:Fira Code,Monaco,Consolas,monospace;font-size:.9rem;resize:vertical;margin-bottom:12px}.demo-textarea:focus{outline:none;border-color:var(--primary)}.editor-section{margin-bottom:20px}.editor-actions{display:flex;gap:8px}.file-list-section h5,.tree-section h5{font-size:.95rem;margin-bottom:12px;color:var(--text)}.demo-list{border:1px solid var(--border);border-radius:var(--radius);max-height:300px;overflow-y:auto}.demo-list .placeholder{padding:24px;text-align:center;color:var(--text-muted);font-style:italic}.list-item{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--border);gap:12px}.list-item:last-child{border-bottom:none}.list-item:hover{background:#f9fafb}.item-info{flex:1;min-width:0}.item-info strong{display:block;font-size:.95rem;margin-bottom:2px}.item-meta{font-size:.8rem;color:var(--text-muted)}.quota-display{margin-top:16px;padding:12px;background:#f8fafc;border-radius:var(--radius);font-size:.85rem;color:var(--text-muted)}.demo-tree{border:1px solid var(--border);border-radius:var(--radius);background:#1e293b;color:#e2e8f0;max-height:300px;overflow:auto}.demo-tree .placeholder{padding:24px;text-align:center;color:#94a3b8}.tree-view{margin:0;padding:16px;font-family:Fira Code,Monaco,Consolas,monospace;font-size:.85rem;line-height:1.8;white-space:pre}.walk-stats{margin-top:12px;font-size:.85rem;color:var(--text-muted)}.drop-zone{border:2px dashed var(--border);border-radius:var(--radius);padding:40px;text-align:center;cursor:pointer;transition:all .2s;margin-bottom:16px}.drop-zone:hover,.drop-zone.dragover{border-color:var(--primary);background:#3b82f60d}.drop-content .drop-icon{font-size:3rem;display:block;margin-bottom:12px}.drop-hint{font-size:.85rem;color:var(--text-muted);margin-top:8px}.drop-results{border:1px solid var(--border);border-radius:var(--radius);max-height:300px;overflow-y:auto}.drop-results .placeholder{padding:24px;text-align:center;color:var(--text-muted)}.result-item{padding:16px;border-bottom:1px solid var(--border)}.result-item:last-child{border-bottom:none}.result-item strong{display:block;margin-bottom:4px}.content-preview{background:#f8fafc;padding:12px;border-radius:var(--radius);font-size:.8rem;margin-top:8px;max-height:100px;overflow:auto;white-space:pre-wrap;word-break:break-all}.demo-separator{margin:24px 0 16px}.demo-separator h3{color:var(--text-muted);font-size:.95rem;font-weight:600}.examples-container{display:flex;flex-direction:column;gap:16px}.example-card{border:1px solid var(--border);border-radius:var(--radius);padding:16px;background:#fafafa}.example-header{margin-bottom:12px}.example-header h3{font-size:1rem;margin-bottom:4px;color:var(--primary)}.example-desc{font-size:.85rem;color:var(--text-muted);margin:0}.example-result{margin-top:16px;padding-top:16px;border-top:1px solid var(--border)}.result-message{font-weight:500;padding:8px 12px;border-radius:var(--radius);margin:0 0 12px}.result-message.success{background:#d4edda;color:#155724}.result-message.error{background:#f8d7da;color:#721c24}.result-data,.result-code{margin-top:12px}.result-data h4,.result-code h4{font-size:.85rem;color:var(--text-muted);margin-bottom:8px}.result-data pre{background:#f1f5f9;padding:12px;border-radius:var(--radius);overflow-x:auto;font-size:.8rem;line-height:1.4;max-height:200px;overflow-y:auto}.result-data code{font-family:Fira Code,Monaco,Consolas,monospace}.code-block{background:#1e293b;color:#e2e8f0;padding:16px;border-radius:var(--radius);overflow-x:auto}.code-block pre{margin:0;font-family:Fira Code,Monaco,Consolas,monospace;font-size:.85rem;line-height:1.6}.error-container{max-width:600px;margin:50px auto;padding:24px;background:#fee2e2;border-radius:var(--radius);text-align:center}.error-container h2{color:var(--danger);margin-bottom:12px}.error-container p{color:#991b1b;margin-bottom:8px}.error-detail{font-size:.85rem;font-family:monospace}.error-container button{margin-top:16px;padding:10px 24px;background:var(--danger);color:#fff;border:none;border-radius:var(--radius);cursor:pointer}.info-banner{margin-top:16px;padding:12px 16px;background:#fef3c7;border:1px solid #f59e0b;border-radius:var(--radius);color:#92400e;font-size:.9rem;text-align:left}.info-banner strong{display:block;margin-bottom:4px}.info-banner .info-detail{font-size:.85rem;opacity:.9}.opfs-unavailable{background:linear-gradient(135deg,#fef3c7,#fed7aa);border:2px solid #f59e0b}.opfs-unavailable h4{color:#92400e}.unavailable-bug-notice{margin:16px 0;padding:16px;background:linear-gradient(135deg,#fee2e2,#fecaca);border:2px solid #dc2626;border-radius:var(--radius);text-align:left}.unavailable-bug-notice h5{font-size:1rem;color:#991b1b;margin-bottom:10px}.unavailable-bug-notice p{font-size:.85rem;color:#7f1d1d;margin-bottom:8px}.unavailable-bug-notice ul{list-style:none;padding:0;margin:0}.unavailable-bug-notice li{padding:4px 0;font-size:.85rem;color:#7f1d1d}.unavailable-bug-notice a{color:#dc2626;font-weight:500;text-decoration:underline}.unavailable-bug-notice a:hover{color:#991b1b}.unavailable-reasons,.unavailable-error,.unavailable-alternatives{margin-top:16px;text-align:left}.unavailable-alternatives a{color:#b45309;text-decoration:underline}.unavailable-alternatives a:hover{color:#92400e}.unavailable-reasons h5,.unavailable-error h5,.unavailable-alternatives h5{font-size:.9rem;color:#92400e;margin-bottom:8px}.unavailable-reasons ul,.unavailable-alternatives ul{list-style:none;padding:0;margin:0}.unavailable-reasons li,.unavailable-alternatives li{padding:6px 0;font-size:.85rem;color:#78350f}.unavailable-error code{display:block;padding:12px;background:#0000001a;border-radius:var(--radius);font-size:.8rem;word-break:break-all;color:#78350f}.tab.disabled-tab{opacity:.6;position:relative}.tab.disabled-tab:after{content:"‚ö†Ô∏è";position:absolute;top:-4px;right:-4px;font-size:.7rem}.loading{text-align:center;padding:20px;color:var(--text-muted)}.placeholder{text-align:center;padding:20px;color:var(--text-muted);font-style:italic}@media(max-width:600px){.container{padding:12px}header h1{font-size:1.5rem}.tabs{gap:4px}.tab{padding:8px 10px;font-size:.8rem}.demo-form{flex-direction:column}.demo-form .btn{width:100%}.editor-actions{flex-direction:column}.editor-actions .btn{width:100%}.info-banner{font-size:.85rem;padding:10px 12px}.opfs-unavailable{padding:16px}.unavailable-reasons li,.unavailable-alternatives li{font-size:.8rem}}</style>
</head>
<body>
<div id="app"></div>
</body>
</html>
